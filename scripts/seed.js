const mongoose = require('mongoose'); const bcrypt = require('bcryptjs'); const UserSchema = new mongoose.Schema({ username:String, passwordHash:String, role:String, mustChangePassword:Boolean }); const User = mongoose.models.User || mongoose.model('User', UserSchema); (async ()=>{ const uri = process.env.MONGODB_URI; if(!uri){ console.error('MONGODB_URI missing'); process.exit(1); } await mongoose.connect(uri); const admin = await User.findOne({ username:'admin' }); if(admin){ console.log('Admin already exists'); } else { const hash = await bcrypt.hash('admin', 10); await User.create({ username:'admin', passwordHash:hash, role:'admin', mustChangePassword:true }); console.log('Admin user created: admin / admin'); } await mongoose.disconnect(); process.exit(0); })();