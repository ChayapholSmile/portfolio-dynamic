import { dbConnect } from '../lib/mongodb'; import Profile from '../models/Profile'; import Education from '../models/Education'; import Work from '../models/Work'; import Project from '../models/Project'; import Base64Image from '../components/Base64Image'; import SectionCard from '../components/SectionCard'; export const dynamic = 'force-dynamic'; async function getData(){ await dbConnect(); const [profile] = await Profile.find({}).limit(1); const education = await Education.find({}).sort({ startDate:-1 }).limit(10); const work = await Work.find({}).sort({ startDate:-1 }).limit(10); const projects = await Project.find({}).sort({ createdAt:-1 }).limit(12); return { profile, education:JSON.parse(JSON.stringify(education)), work:JSON.parse(JSON.stringify(work)), projects:JSON.parse(JSON.stringify(projects)) }; } export default async function Home(){ const { profile, education, work, projects } = await getData(); return (<div className="space-y-8"><SectionCard title={profile?.displayName||'ชื่อผู้สร้าง'} className="relative overflow-hidden"><div className="flex gap-6 items-start"><Base64Image file={profile?.avatar} className="w-28 h-28 rounded-2xl object-cover"/><div><p className="text-white/80">{profile?.bio||'คำอธิบายสั้น ๆ เกี่ยวกับตัวคุณ'}</p></div></div></SectionCard></div>); }