import { dbConnect } from '../../lib/mongodb'; import Blog from '../../models/Blog'; import Base64Image from '../../components/Base64Image'; import Link from 'next/link'; export const dynamic='force-dynamic'; async function getBlogs(){ await dbConnect(); const blogs = await Blog.find({}).sort({createdAt:-1}).limit(50); return JSON.parse(JSON.stringify(blogs)); } export default async function BlogList(){ const blogs = await getBlogs(); return (<div className="space-y-4"><h1 className="text-3xl font-bold mb-4">บล็อก</h1>{blogs.map(b=> (<Link href={`/blog/${b.slug}`} key={b._id} className="card p-4 block"><div className="flex gap-4">{b.cover && <Base64Image file={b.cover} className="w-24 h-24 object-cover rounded-lg"/>}<div><p className="font-semibold">{b.title}</p><p className="text-white/70">{b.excerpt}</p></div></div></Link>))}</div>); }