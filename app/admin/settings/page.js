'use client'; import { useEffect,useState } from 'react'; export default function SettingsPage(){ const [data,setData]=useState({displayName:'',bio:'',social:{},avatar:null}); const [msg,setMsg]=useState(''); useEffect(()=>{ fetch('/api/profile').then(r=>r.json()).then(setData); },[]); const handleFile=(e)=>{ const file=e.target.files[0]; if(!file) return; const reader=new FileReader(); reader.onload=()=>{ const base64=reader.result.split(',')[1]; setData(prev=>({...prev,avatar:{name:file.name,mime:file.type,base64}})); }; reader.readAsDataURL(file); }; const save=async()=>{ setMsg(''); const res=await fetch('/api/profile',{method:'PUT',headers:{'Content-Type':'application/json'},body:JSON.stringify(data)}); if(res.ok) setMsg('บันทึกแล้ว'); else setMsg('บันทึกล้มเหลว'); }; return (<div className="card p-4"><h1 className="text-2xl font-bold mb-4">แก้ไขโปรไฟล์ (Admin เท่านั้น)</h1>{msg && <div className="mb-2">{msg}</div>}<label className="label">ชื่อที่แสดง</label><input className="input mb-3" value={data.displayName||''} onChange={e=>setData({...data,displayName:e.target.value})}/><label className="label">คำอธิบาย</label><textarea className="input mb-3 h-28" value={data.bio||''} onChange={e=>setData({...data,bio:e.target.value})}/><label className="label">รูปโปรไฟล์</label><input type="file" onChange={handleFile} className="mb-4"/><div className="grid sm:grid-cols-2 gap-3"><div><label className="label">Website</label><input className="input" value={data.social?.website||''} onChange={e=>setData({...data, social:{...data.social, website:e.target.value}})}/></div><div><label className="label">GitHub</label><input className="input" value={data.social?.github||''} onChange={e=>setData({...data, social:{...data.social, github:e.target.value}})}/></div><div><label className="label">Twitter</label><input className="input" value={data.social?.twitter||''} onChange={e=>setData({...data, social:{...data.social, twitter:e.target.value}})}/></div><div><label className="label">Email</label><input className="input" value={data.social?.email||''} onChange={e=>setData({...data, social:{...data.social, email:e.target.value}})}/></div></div><button className="btn mt-4" onClick={save}>บันทึก</button></div>); }