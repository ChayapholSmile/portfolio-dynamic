import jwt from 'jsonwebtoken'; import { cookies } from 'next/headers'; const JWT_SECRET = process.env.JWT_SECRET || 'dev-secret'; export function signJwt(payload, options={}){ return jwt.sign(payload, JWT_SECRET, { expiresIn:'7d', ...options }); } export function verifyJwt(token){ try{ return jwt.verify(token, JWT_SECRET); }catch(e){ return null; } } export function getUserFromCookie(){ try{ const c = cookies(); const token = c.get('session')?.value; if(!token) return null; return verifyJwt(token);}catch(e){return null;} }